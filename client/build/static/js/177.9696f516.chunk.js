"use strict";(self.webpackChunkrollup_tool=self.webpackChunkrollup_tool||[]).push([[177],{4236:function(e,t,n){var o=n(1413),r=(n(2791),n(5422)),l=n(6934),a=n(2065),i=n(184),c=(0,l.ZP)((function(e){return(0,i.jsx)(r.Z,(0,o.Z)({elevation:0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},e))}))((function(e){var t=e.theme;return{"& .MuiPaper-root":{borderRadius:6,marginTop:t.spacing(1),minWidth:180,color:"light"===t.palette.mode?"rgb(55, 65, 81)":t.palette.grey[300],boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px","& .MuiMenu-list":{padding:"4px 0"},"& .MuiMenuItem-root":{"& .MuiSvgIcon-root":{fontSize:18,color:t.palette.text.secondary,marginRight:t.spacing(1.5)},"&:active":{backgroundColor:(0,a.Fq)(t.palette.primary.main,t.palette.action.selectedOpacity)}}}}}));t.Z=c},177:function(e,t,n){n.r(t),n.d(t,{default:function(){return R}});var o=n(9439),r=n(5172),l=n(3174),a=n(2899),i=n(5047),c=n(4638),s=n(4721),p=n(2791),u=n(5655),f=n(4236),x=n(5415),d=n.n(x),m=n(4802),h=n.n(m),g=n(49),v=n(9216),b="level",w="Level",y=function(){return new(d().Workbook)},Z=function(e,t){return e.addWorksheet(t)},C=function(e,t){var n=e.addRow();n.fill={type:"pattern",pattern:"solid",fgColor:{argb:g.Z.THEME_MAIN.split("#")[1]}},e.getRow(1).font={bold:!0};var o=1;!function(e,t,n){var o=e.getColumn(n);o.width=10,o.style={font:{bold:!0}},t.getCell(n).value=w}(e,n,o),o+=1,t.forEach((function(r,l){var a=r.getSize();e.getColumn(o).width=void 0!==a?a/6:20,n.getCell(o).value=t[l].columnDef.header,o+=1})),function(e,t){e.autoFilter={from:{row:1,column:1},to:{row:1,column:t.length}},e.views=[{state:"frozen",ySplit:2,xSplit:1}]}(e,t)},E=function(e,t,n){var o=(0,v.s)(n);o.forEach((function(n){var o=e.addRow(),r=1;!function(e,t,n){var o=e.getCell(n);o.value=t[b],o.alignment={vertical:"middle",horizontal:"center"}}(o,n,r),r+=1,t.forEach((function(e){var t=n[e.id],l=e.columnDef.header.includes("Date");o.getCell(r).value=l?new Date(t):t,r+=1}))})),function(e,t){var n=t.length;console.log(n),e.addConditionalFormatting({ref:"A2:O".concat(n),rules:[{type:"expression",formulae:["MOD(ROW(),2)=0"],style:{fill:{type:"pattern",pattern:"solid",bgColor:{argb:"D3D3D3"}}}}]})}(e,o)},j=function(e,t){var n=t[0].title,o=y(),r=Z(o,n);C(r,e),E(r,e,t),function(e,t){e.xlsx.writeBuffer().then((function(e){h()(new Blob([e],{type:"application/octet-stream"}),t)}))}(o,"Export_".concat(n,".xlsx"))},M=function(e,t){var n=t[0].title,o=y(),r=Z(o,n);C(r,e),E(r,e,t),function(e,t){e.csv.writeBuffer().then((function(e){h()(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),t)}))}(o,"Export_".concat(n,".csv"))},S=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"root",o="<".concat(n,">");return t.forEach((function(t){o+="<element>",Object.keys(t).forEach((function(n){var r=t[n];o+="object"===typeof r?e(r,n):"<".concat(n,">").concat(r,"</").concat(n,">")})),o+="</element>"})),o+="</".concat(n,">")},k=function(e){!function(e,t){h()(new Blob([e],{type:"text/plain;charset=utf-8"}),t)}(function(e){var t=(new DOMParser).parseFromString(e,"application/xml"),n=(new DOMParser).parseFromString(['<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform">','  <xsl:strip-space elements="*"/>','  <xsl:template match="para[content-style][not(text())]">','    <xsl:value-of select="normalize-space(.)"/>',"  </xsl:template>",'  <xsl:template match="node()|@*">','    <xsl:copy><xsl:apply-templates select="node()|@*"/></xsl:copy>',"  </xsl:template>",'  <xsl:output indent="yes"/>',"</xsl:stylesheet>"].join("\n"),"application/xml"),o=new XSLTProcessor;o.importStylesheet(n);var r=o.transformToDocument(t);return(new XMLSerializer).serializeToString(r)}(S(e)),"EBOM_Export.xml")},D=n(4511),z=n(1868),O=n(184),R=function(e){var t=e.table,n=p.useState(null),x=(0,o.Z)(n,2),d=x[0],m=x[1];return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(z.Z,{onClick:function(e){return m(e.currentTarget)},endIcon:(0,O.jsx)(r.Z,{}),children:"Export"}),(0,O.jsxs)(f.Z,{keepMounted:!0,anchorEl:d,open:Boolean(d),onClose:function(){return m(null)},children:[(0,O.jsxs)(c.Z,{onClick:function(){try{var e=(0,D.bi)(t),n=e.columns,o=e.rows;j(n,o)}catch(r){console.error(r),u.ZP.error(r.message||r)}},disableRipple:!0,children:[(0,O.jsx)(l.Z,{}),"Export Excel"]}),(0,O.jsx)(s.Z,{}),(0,O.jsxs)(c.Z,{onClick:function(){try{var e=(0,D.bi)(t),n=e.columns,o=e.rows;M(n,o)}catch(r){console.error(r),u.ZP.error(r.message||r)}},disableRipple:!0,children:[(0,O.jsx)(a.Z,{}),"Export CSV"]}),(0,O.jsx)(s.Z,{}),(0,O.jsxs)(c.Z,{onClick:function(){try{var e=(0,D.bi)(t).rows;k(e)}catch(n){console.error(n),u.ZP.error(n.message||n)}},disableRipple:!0,children:[(0,O.jsx)(i.Z,{}),"Export XML"]})]})]})}},1868:function(e,t,n){var o=n(1413),r=n(5987),l=n(6151),a=(n(2791),n(184)),i=["children"];t.Z=function(e){var t=e.children,n=(0,r.Z)(e,i);return(0,a.jsx)(l.Z,(0,o.Z)((0,o.Z)({variant:"contained",disableElevation:!0},n),{},{size:"small",children:t}))}}}]);
//# sourceMappingURL=177.9696f516.chunk.js.map